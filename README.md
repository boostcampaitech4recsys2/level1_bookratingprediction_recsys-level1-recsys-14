# Book Rating Prediction

![image](https://user-images.githubusercontent.com/80964004/202848295-b8b91cb6-6fce-4b7f-8bdc-f683ca6f6028.png)

## íŒ€ì› ì†Œê°œ
|ì´ë¦„|ê¹ƒí—ˆë¸Œ|ì—­í• |
|----|---|---|
|ê¹€ë‹¤ì€|[GitHub](https://github.com/daeni-dang)|NCF ëª¨ë¸ ì—°êµ¬ ë° ì‹¤í—˜, FFM ëª¨ë¸ì— k-fold ì ìš©|
|ê¹€ë™ì˜|[GitHub](https://github.com/ktasha45)|deepconn ëª¨ë¸ ê³ ë„í™”. deepconn+FFM ëª¨ë¸ ê°œë°œ. í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ ìë™í™”|
|ê¹€ë³´ì„±|[GitHub](https://github.com/bo-oseng)|Hybird Model(NCF + FFM) ì‹¤í—˜, Custom Ensemble(Warm + Cold) ì‹¤í—˜, lightFM ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª¨ë¸ ì—°êµ¬ ë° ì‹¤í—˜|
|ë¥˜ì§€ìˆ˜|[GitHub](https://github.com/JisooRyu99)|FM, FFM ëª¨ë¸ ì—°êµ¬ ë° ì‹¤í—˜, EDA(ê²°ì¸¡ì¹˜ ë³´ì™„), í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ ìë™í™”|
|í™ì¬í˜•|[GitHub](https://github.com/secrett2633)|CNN_FM ì—°êµ¬ ë° ì‹¤í—˜, EDA(ê²°ì¸¡ì¹˜ ë³´ì™„)|


## í”„ë¡œì íŠ¸ ëª©í‘œ
 ëŒ€í•œì¶œíŒë¬¸í™”í˜‘íšŒì— ë”°ë¥´ë©´ 2021ë…„ ëŒ€í•œë¯¼êµ­ ì‹ ê°„ ë°œí–‰ ì±…ì€ 64,657ê¶Œì…ë‹ˆë‹¤. ì±…ì„ ì½ê¸° ìœ„í•´ ì†Œìš”ë˜ëŠ” ì‹œê°„ê³¼ ì±…ì„ êµ¬ë§¤í•˜ëŠ” ë¹„ìš© ì¸¡ë©´ì—ì„œ êµ¬ë§¤í•  ì±…ì„ ì„ íƒí•˜ëŠ” ê²ƒì€ ì¤‘ìš”í•œ ë¬¸ì œì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì†Œë¹„ìëŠ” ì œëª©, ì €ì, í‘œì§€, ì¹´í…Œê³ ë¦¬ ë“± ê·¸ ì±…ì˜ ì •ë³´ì™€ íƒ€ êµ¬ë§¤ìë“¤ì˜ ë¦¬ë·°ì™€ í‰ì ë§Œìœ¼ë¡œ ì±…ì„ ì„ íƒí•´ì•¼í•©ë‹ˆë‹¤.

 ë³¸ ëŒ€íšŒëŠ” ì†Œë¹„ìë“¤ì˜ ì±… êµ¬ë§¤ ê²°ì •ì— ë„ì›€ì„ ì£¼ê¸° ìœ„í•´ ì†Œë¹„ìê°€ ì±…ì— ëŒ€í•´ ë‚´ë¦´ í‰ì ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.
 
 ## í”„ë¡œì íŠ¸ êµ¬ì¡°
```bash
|ğŸ“¦ code
|    |ğŸ“‚ data
|        |ğŸ“œ images
|        |ğŸ“œ train_ratings.csv
|        |ğŸ“œ test_ratings.csv
|        |ğŸ“œ books.csv
|        |ğŸ“œ sample_submission.csv
|        |ğŸ“œ users.csv
|    |ğŸ“‚ models
|        |ğŸ“œ FFM.pt
|    |ğŸ“‚ src
|        |ğŸ“‚ data
|            |ğŸ“œ __init__.py
|            |ğŸ“œ dl_data.py
|            |ğŸ“œ context_data.py
|            |ğŸ“œ image_data.py
|            |ğŸ“œ text_data.py
|        |ğŸ“‚ ensembles
|            |ğŸ“œ ensembles.py
|        |ğŸ“‚ models
|            |ğŸ“œ _models.py
|            |ğŸ“œ dl_models.py
|            |ğŸ“œ context_models.py
|            |ğŸ“œ image_models.py
|            |ğŸ“œ text_models.py
|        |ğŸ“œ __init__.py
|        |ğŸ“œ utils.py
|    |ğŸ“‚ submit
|    |ğŸ“œ main.py
|    |ğŸ“œ ensemble.py
```

## ë°ì´í„°ì…‹ êµ¬ì¡°
ì£¼ì–´ì§„ ë°ì´í„°ëŠ” `.csv` í˜•ì‹ì˜ íŒŒì¼ë¡œ, ì‚¬ìš©ì(user)ê³¼ ì±…(item)ì˜ ì •ë³´ ê·¸ë¦¬ê³  ì‚¬ìš©ì(user)ê°€ ì±…(item)ì— ë§¤ê¸´ í‰ì  ë°ì´í„°ì…ë‹ˆë‹¤.
- `users.csv` : 68,092ëª…ì˜ ì‚¬ìš©ì(user)ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ë©”íƒ€ë°ì´í„°
- `books.csv` : 149,570ê°œì˜ ì±…(item)ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ë©”íƒ€ë°ì´í„°
- `train_ratings.csv` : 59,803ëª…ì˜ ì‚¬ìš©ì(user)ê°€ 129,777ê°œì˜ ì±…(item)ì— ëŒ€í•´ ë‚¨ê¸´ 306,795ê±´ì˜ í‰ì (rating) ë°ì´í„°

## ì¶œë ¥ ë°ì´í„°
 ìµœì¢… ê²°ê³¼ë¬¼ì€ ì£¼ì–´ì§„ ì±…ì— ëŒ€í•´ ì‚¬ìš©ìê°€ ë§¤ê¸¸ ê²ƒì´ë¼ê³  ì˜ˆìƒí•˜ëŠ” í‰ì ì„ ì±„ì›Œ ë„£ì€ .csv í˜•íƒœì˜ íŒŒì¼ë¡œ, ì•„ë˜ `sample_submission.csv` íŒŒì¼ê³¼ ê°™ì´ ì¶œë ¥í•´ì•¼ í•©ë‹ˆë‹¤.
| user_id | isbn | rating |
| --- | --- | --- |
| 11676 | 0002005018 | 7.4152054786 |
| 116866 | 0002005018 | 8.3852987289 |
| 152827 | 0060973129 | 8.0158720016 |

## ëª¨ë¸ ê°œì„ 
- baselineì—ëŠ” ì—†ëŠ” earlystopping ê¸°ëŠ¥ ì¶”ê°€, ë³´ë‹¤ ì •í™•í•œ ì‹¤í—˜ì„ ìœ„í•´ rmse ë„ì¶œ ì½”ë“œë¥¼ ìˆ˜ì •
- shell scriptì™€ tensorboardë¥¼ ì´ìš©í•´ì„œ ìµœì ì˜ hyper-parameterì„ ì°¾ê³  í•™ìŠµ
- 10-fold validationì„ ëª©í‘œë¡œ ëª¨ë¸ì„ í•™ìŠµ í–ˆìœ¼ë‚˜ ì‹œê°„ì´ ë¶€ì¡±í•˜ì—¬ 4-fold vaildationì˜ ê²°ê³¼ë¥¼ ì œì¶œ

## ìµœì¢… ê²°ê³¼
**Model** : `FFM`

**Hyper-Parameter** : `batch_size 256` `learning_rate 0.01` `weight_decay 1e-4` `epochs 10`

10-fold (4ë²ˆ foldì—ì„œ ë©ˆì¶¤)

- CV score (valid) : RMSE 2.1758
- LB score (Public) : RMSE 2.1414
- LB score (Private) : RMSE 2.1418
